# 🎬 游戏视频生成器 - 本地预览指南

## 📋 目录
- [环境准备](#环境准备)
- [快速启动](#快速启动)
- [功能检查清单](#功能检查清单)
- [常见问题](#常见问题)
- [正式部署准备](#正式部署准备)

---

## 🔧 环境准备

### 1. 系统要求
- ✅ Windows 10/11
- ✅ Node.js 18+ (已安装)
- ✅ npm 或 pnpm
- ✅ 浏览器 (Chrome/Edge 推荐)

### 2. 依赖检查
```bash
# 检查 Node.js 版本
node --version
# 应该显示: v18.x.x 或更高

# 检查 npm 版本
npm --version
# 应该显示: 8.x.x 或更高
```

### 3. 环境变量配置

创建 `.env.local` 文件（如果还没有）:

```env
# FAL.AI API
NEXT_PUBLIC_FAL_KEY=77c2b2ce-ed73-4a19-9790-21e674c144a9:811b480911387d8c54ea5d013efb284a

# OpenAI API (需要配置)
OPENAI_API_KEY=your_openai_api_key_here

# Supabase (可选 - 用于存储历史)
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_key

# 应用配置
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

---

## 🚀 快速启动

### 方式 1: 使用批处理文件 (推荐)

#### 步骤 1: 双击 `START_DEV.bat`

创建启动文件:
```batch
@echo off
title 游戏视频生成器 - 开发环境
color 0A

echo.
echo ╔════════════════════════════════════════════════════════════╗
echo ║     游戏视频生成器 - 本地开发环境启动                        ║
echo ╚════════════════════════════════════════════════════════════╝
echo.

cd /d C:\Users\jojo1\jilo-ai

echo [1/3] 检查依赖...
if not exist "node_modules" (
    echo ⚠ 未找到 node_modules，正在安装依赖...
    call npm install
    if errorlevel 1 (
        echo ❌ 依赖安装失败！
        pause
        exit /b 1
    )
) else (
    echo ✅ 依赖已安装
)

echo.
echo [2/3] 检查环境变量...
if not exist ".env.local" (
    echo ⚠ 未找到 .env.local 文件
    echo 💡 请确保已配置必要的 API Keys
    pause
) else (
    echo ✅ 环境变量文件存在
)

echo.
echo [3/3] 启动开发服务器...
echo.
echo 🌐 应用将在浏览器中打开: http://localhost:3000
echo 📱 游戏视频生成器: http://localhost:3000/game-video-gen
echo.
echo 按 Ctrl+C 可停止服务器
echo.

start http://localhost:3000/game-video-gen
npm run dev
```

#### 步骤 2: 等待启动完成

看到以下信息表示成功:
```
✓ Ready in 3.2s
○ Local:        http://localhost:3000
○ Network:      http://192.168.x.x:3000
```

#### 步骤 3: 自动打开浏览器

浏览器会自动打开: `http://localhost:3000/game-video-gen`

### 方式 2: 命令行启动

```bash
# 进入项目目录
cd C:\Users\jojo1\jilo-ai

# 安装依赖（如果还没安装）
npm install

# 启动开发服务器
npm run dev
```

然后在浏览器中打开: http://localhost:3000/game-video-gen

---

## ✅ 功能检查清单

### 第一部分: 页面加载

- [ ] 页面能正常打开，无白屏
- [ ] 页面标题显示: "AI游戏视频生成器"
- [ ] 所有样式正常加载（Tailwind CSS）
- [ ] 无控制台错误

### 第二部分: 表单功能

#### 基础输入
- [ ] 游戏名称输入框可用
- [ ] 游戏介绍文本框可用
- [ ] 字符限制提示正确显示

#### 配置选项
- [ ] **语言选择**: 中文/English 切换正常
- [ ] **平台选择**: 抖音/快手/YouTube 可选
- [ ] **时长选择**: 4秒/8秒/12秒 可选
  - [ ] 场景数量自动计算正确 (2/4/6)
  - [ ] 成本预估自动更新
- [ ] **格式选择**: 竖屏/横屏 切换正常
  - [ ] 根据平台自动推荐格式

#### 联动逻辑
- [ ] 选择"抖音"时，自动推荐"竖屏"
- [ ] 选择"快手"时，自动推荐"竖屏"
- [ ] 选择"YouTube"时，自动推荐"横屏"
- [ ] 选择"4秒"时，显示"2个场景"
- [ ] 选择"8秒"时，显示"4个场景"
- [ ] 选择"12秒"时，显示"6个场景"

### 第三部分: 视频生成流程

#### 准备阶段
- [ ] 点击"生成视频"按钮
- [ ] 表单验证正常工作
- [ ] 必填字段验证生效

#### 生成阶段
- [ ] 进度条正常显示
- [ ] 显示"正在生成脚本..."
- [ ] 显示"正在生成视频..."
- [ ] 场景进度正确显示 (1/4, 2/4...)
- [ ] 预计剩余时间显示

#### 完成阶段
- [ ] 生成成功提示
- [ ] 视频预览播放器显示
- [ ] 视频信息正确显示:
  - [ ] 平台名称
  - [ ] 视频时长
  - [ ] 视频格式
  - [ ] 语言信息
  - [ ] 分辨率
  - [ ] 成本信息
- [ ] 下载按钮可用
- [ ] 重新生成按钮可用

### 第四部分: 视频预览

- [ ] 视频播放器正常加载
- [ ] 音频播放正常
- [ ] 播放控制按钮可用
- [ ] 全屏功能正常
- [ ] 进度条可拖动

### 第五部分: 历史记录 (如果启用)

- [ ] 历史记录列表显示
- [ ] 筛选功能正常:
  - [ ] 按平台筛选
  - [ ] 按时长筛选
- [ ] 缩略图正常显示
- [ ] 查看/下载/删除按钮可用

---

## 🔍 详细测试步骤

### 测试案例 1: 抖音 8秒视频 (推荐首次测试)

1. **填写表单**:
   ```
   游戏名称: 狱国争霸
   游戏介绍: 史诗级中世纪监狱策略游戏，管理资源、招募英雄、征战四方
   语言: 中文简体
   平台: 抖音
   时长: 8秒
   格式: 竖屏 (9:16)
   ```

2. **点击生成**: 等待 1-2 分钟

3. **预期结果**:
   - 成本: ~$0.18
   - 时长: 8秒
   - 场景: 4个
   - 格式: 1080x1920 (竖屏)

### 测试案例 2: YouTube 12秒视频

1. **填写表单**:
   ```
   游戏名称: Prison Empire
   游戏介绍: Epic medieval prison strategy game with resource management
   语言: English
   平台: YouTube
   时长: 12秒
   格式: 横屏 (16:9)
   ```

2. **点击生成**: 等待 2-3 分钟

3. **预期结果**:
   - 成本: ~$0.25
   - 时长: 12秒
   - 场景: 6个
   - 格式: 1920x1080 (横屏)

### 测试案例 3: 快速测试 (4秒)

1. **填写表单**:
   ```
   游戏名称: 测试游戏
   游戏介绍: 这是一个测试，验证4秒视频生成功能是否正常工作
   语言: 中文简体
   平台: 快手
   时长: 4秒
   格式: 竖屏 (9:16)
   ```

2. **点击生成**: 等待 30-60 秒

3. **预期结果**:
   - 成本: ~$0.10
   - 时长: 4秒
   - 场景: 2个
   - 快速完成

---

## ⚠️ 常见问题

### 问题 1: 页面打不开

**症状**: 访问 http://localhost:3000 显示无法访问

**解决方案**:
```bash
# 检查端口是否被占用
netstat -ano | findstr :3000

# 如果被占用，终止进程
taskkill /PID [进程ID] /F

# 或使用其他端口启动
npm run dev -- -p 3001
```

### 问题 2: 样式显示异常

**症状**: 页面显示但样式混乱

**解决方案**:
```bash
# 清除 Next.js 缓存
rm -rf .next
npm run dev
```

### 问题 3: API 调用失败

**症状**: 视频生成失败，显示 API 错误

**检查事项**:
- [ ] `.env.local` 文件是否存在
- [ ] FAL_KEY 是否正确配置
- [ ] OPENAI_API_KEY 是否配置
- [ ] 网络连接是否正常

**调试方法**:
1. 打开浏览器开发者工具 (F12)
2. 查看 Console 标签页的错误信息
3. 查看 Network 标签页的 API 请求

### 问题 4: 视频加载慢

**症状**: 视频生成后加载很慢

**原因**: 视频文件较大，网络速度影响

**解决方案**:
- 耐心等待完整加载
- 或直接下载视频到本地播放

### 问题 5: 热更新不工作

**症状**: 修改代码后页面不自动刷新

**解决方案**:
```bash
# 重启开发服务器
# 按 Ctrl+C 停止
npm run dev
```

---

## 🎨 UI/UX 检查清单

### 视觉设计
- [ ] 整体配色协调
- [ ] 字体清晰易读
- [ ] 按钮状态明确（正常/悬停/禁用）
- [ ] 输入框焦点状态清晰
- [ ] 加载动画流畅

### 响应式设计
- [ ] 大屏幕 (1920x1080) 显示正常
- [ ] 笔记本 (1366x768) 显示正常
- [ ] 平板 (iPad) 显示正常 (可选)
- [ ] 手机 (375x667) 显示正常 (可选)

### 交互体验
- [ ] 按钮点击反馈明确
- [ ] 表单验证提示友好
- [ ] 错误信息清晰易懂
- [ ] 成功提示明显
- [ ] Loading 状态明确

### 性能表现
- [ ] 页面初次加载 < 3秒
- [ ] 表单交互流畅无卡顿
- [ ] 视频预览加载合理
- [ ] 无明显内存泄漏

---

## 🚀 正式部署准备

### 预部署检查清单

#### 代码质量
- [ ] 所有功能测试通过
- [ ] 无 console.error 或 console.warn
- [ ] 无 TypeScript 类型错误
- [ ] 代码格式化完成

#### 环境配置
- [ ] 生产环境变量准备完毕
- [ ] API Keys 已在 Vercel 配置
- [ ] 域名已准备（如果需要）

#### 数据库
- [ ] Supabase 项目创建完成
- [ ] 数据库表结构创建完成
- [ ] RLS (行级安全) 策略配置
- [ ] API Keys 已获取

#### 性能优化
- [ ] 图片已优化
- [ ] 代码已压缩
- [ ] 静态资源已 CDN 部署（如需要）

### 部署方式选择

#### 选项 1: Vercel 部署 (推荐)

**优点**:
- ✅ 最简单，一键部署
- ✅ 自动 HTTPS
- ✅ CDN 全球加速
- ✅ 自动构建和更新

**步骤**:
1. 推送代码到 GitHub
2. 在 Vercel 导入项目
3. 配置环境变量
4. 点击部署

#### 选项 2: 自建服务器

**适用场景**:
- 需要完全控制
- 有特殊网络需求
- 成本敏感

**要求**:
- Node.js 环境
- Nginx/Apache
- SSL 证书
- 域名

---

## 📝 部署前最终检查

### 功能测试
- [ ] 所有测试案例通过
- [ ] 边界情况测试
- [ ] 错误处理测试

### 安全检查
- [ ] API Keys 不在代码中
- [ ] 环境变量正确配置
- [ ] CORS 配置正确
- [ ] 速率限制设置

### 用户体验
- [ ] 所有文案准确
- [ ] 错误提示友好
- [ ] 加载提示清晰
- [ ] 成功反馈明确

### 文档完整
- [ ] README.md 更新
- [ ] API 文档完整
- [ ] 用户指南准备
- [ ] 常见问题整理

---

## 📞 获取帮助

### 遇到问题？

1. **查看控制台**: 打开浏览器 F12，查看 Console 错误
2. **查看文档**: 参考 `README.md` 和 `PRD` 文档
3. **检查日志**: 查看终端输出的详细信息
4. **测试 API**: 使用 `game-video-gen/` 下的测试脚本验证 API

### 准备部署？

参考下一个文档:
- `DEPLOYMENT_GUIDE.md` - 详细部署指南
- `VERCEL_DEPLOY.md` - Vercel 部署步骤

---

## ✨ 预览成功后的下一步

1. ✅ **本地预览完成**
2. ⏭️ 创建 GitHub 仓库
3. ⏭️ 配置 Vercel 项目
4. ⏭️ 设置环境变量
5. ⏭️ 部署到生产环境
6. ⏭️ 配置自定义域名
7. ⏭️ 监控和优化

---

**文档版本**: v1.0  
**最后更新**: 2025-10-27  
**状态**: 准备预览

祝预览顺利！🚀
